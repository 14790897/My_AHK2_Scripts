# 发布前检查清单

在创建新版本发布前，请确保完成以下检查：

## 📝 代码质量

- [ ] 所有 `.ahk` 脚本可以正常运行
- [ ] 没有语法错误或警告
- [ ] 代码注释清晰完整
- [ ] 移除了调试代码和临时文件

## 🧪 功能测试

### WindowIMEMemory
- [ ] 脚本运行正常（双击 .ahk）
- [ ] 编译后的 .exe 正常运行
- [ ] 管理员权限自动提升
- [ ] 托盘图标正确显示
- [ ] 托盘菜单功能正常
  - [ ] 显示脚本信息
  - [ ] 设置开机自启动
  - [ ] 取消开机自启动
  - [ ] 重新加载
  - [ ] 退出
- [ ] 输入法状态正确记忆和恢复
- [ ] 切换窗口时输入法正确切换
- [ ] ini 文件正确读写

### AutoLanguage（如果存在）
- [ ] 脚本正常运行
- [ ] 编译后正常运行
- [ ] 输入法切换正常

### FixMiddleClick（如果测试）
- [ ] 防抖动功能正常
- [ ] 不影响正常使用

## 📚 文档更新

- [ ] README.md 更新
  - [ ] 功能描述准确
  - [ ] 使用说明清晰
  - [ ] 链接都正确
  - [ ] 徽章显示正常
- [ ] CHANGELOG.md 更新
  - [ ] 记录了所有重要更改
  - [ ] 版本号正确
  - [ ] 日期正确
- [ ] 版本号一致
  - [ ] CHANGELOG.md
  - [ ] README.md（如有提及）

## 🔧 编译测试

- [ ] 使用 compile.bat 编译成功
- [ ] 使用 PowerShell 命令编译成功
- [ ] 生成的 exe 文件大小正常（约 1.2-1.3 MB）
- [ ] exe 文件可以独立运行
- [ ] exe 包含正确的图标

## 🚀 GitHub 准备

- [ ] 所有更改已提交到 main 分支
- [ ] 没有未提交的更改
- [ ] Git 状态干净（`git status` 显示没有未跟踪文件）
- [ ] GitHub Actions workflow 文件正确
  - [ ] `.github/workflows/release.yml` 存在
  - [ ] AutoHotkey 下载链接有效
  - [ ] 编译命令正确
  - [ ] 上传文件列表正确

## 📦 发布准备

- [ ] 确定版本号（vX.Y.Z 格式）
- [ ] 准备发布说明
- [ ] 确认要包含的文件
  - [ ] WindowIMEMemory.exe
  - [ ] AutoLanguage.exe（可选）
  - [ ] 源码压缩包

## ✅ 最终检查

- [ ] 在 Windows 10 上测试
- [ ] 在 Windows 11 上测试（如可能）
- [ ] 多次运行确保稳定性
- [ ] 检查内存占用是否正常
- [ ] 确认没有资源泄漏
- [ ] 测试长时间运行（至少 30 分钟）

## 🎯 发布流程

1. **完成上述所有检查**

2. **运行发布脚本**
   ```powershell
   .\release.ps1 v1.0.0 "Release description"
   ```
   或手动：
   ```bash
   git tag -a v1.0.0 -m "Release version 1.0.0"
   git push origin v1.0.0
   ```

3. **监控 GitHub Actions**
   - 访问 Actions 页面
   - 确保构建成功
   - 检查是否有错误

4. **验证 Release**
   - 检查 Release 页面
   - 下载并测试发布的文件
   - 确认发布说明正确

5. **公告发布**
   - 更新 README.md（如需要）
   - 通知用户（如有相关渠道）

## 🐛 如果出现问题

- **编译失败**
  - 检查 AutoHotkey 版本
  - 检查脚本语法
  - 查看 Actions 日志

- **Action 失败**
  - 检查 workflow 文件
  - 确认权限设置
  - 查看详细错误信息

- **Release 创建失败**
  - 检查 GITHUB_TOKEN 权限
  - 确认标签格式正确
  - 查看 Actions 日志

## 📝 发布后

- [ ] 测试下载的 exe 文件
- [ ] 更新文档链接（如需要）
- [ ] 回应 Issue 和 PR
- [ ] 计划下一个版本

---

**检查清单版本**: 1.0
**最后更新**: 2026-02-15
